(this["webpackJsonpgraph-viz"]=this["webpackJsonpgraph-viz"]||[]).push([[0],{147:function(e,t,n){},218:function(e,t,n){e.exports=n(276)},223:function(e,t,n){},276:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(114),i=n.n(r),c=(n(223),n(147),n(16)),s=n(140),l=n(22),u=n(9),d=n(21),m=n(4),p=n.n(m),g=n(14),f=n(43),h=n(66),E=n(70),v=n(67),b=n(181),T=n(6),N=n(182),w=n(144),x=function(){var e=Object(g.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.session(),e.prev=1,console.log("Starting timestamp migration..."),e.next=5,n.run("MATCH (u:User)\n       WHERE u.createdAt IS NULL\n       SET u.createdAt = $timestamp\n       RETURN count(u) as updatedNodes",{timestamp:Date.now()});case 5:return e.sent,e.next=8,n.run("MATCH ()-[r:CONNECTED_TO]->()\n       WHERE r.createdAt IS NULL\n       SET r.createdAt = $timestamp\n       RETURN count(r) as updatedRelationships",{timestamp:Date.now()});case 8:e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error("Error during timestamp migration:",e.t0);case 14:return e.prev=14,n.close(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})));return function(t){return e.apply(this,arguments)}}(),C=function(e){Object(v.a)(n,e);var t=Object(E.a)(n);function n(e){var o,r=e.driver;return Object(f.a)(this,n),(o=t.call(this)).startBreathingAnimation=function(){o.breathingInterval&&clearInterval(o.breathingInterval),o.breathingInterval=setInterval((function(){o.state.isUserActive||!o.fgRef.current||o.state.timelineMode||o.triggerBreathingCycle()}),4e3)},o.stopBreathingAnimation=function(){o.breathingInterval&&(clearInterval(o.breathingInterval),o.breathingInterval=null),o.fgRef.current&&"contracted"===o.breathingState&&o.expandNodes()},o.triggerBreathingCycle=function(){"expanded"===o.breathingState?o.contractNodes():o.expandNodes()},o.contractNodes=function(){if(o.fgRef.current){o.breathingState="contracted";var e=o.fgRef.current,t=.01,n=(.05-t)/20;!function o(){t<.05&&(t+=n,e.d3Force("breathing-attraction",w.a(0,0,10).strength(t)),e.d3ReheatSimulation(),setTimeout(o,100))}(),setTimeout((function(){o.expandNodes()}),1e4)}},o.expandNodes=function(){if(o.fgRef.current){o.breathingState="expanded";var e=o.fgRef.current;if(e.d3Force("breathing-attraction")){var t=.05,n=t/20;!function o(){t>.001?(t-=n,e.d3Force("breathing-attraction",w.a(0,0,10).strength(t)),e.d3ReheatSimulation(),setTimeout(o,100)):(e.d3Force("breathing-attraction",null),e.d3ReheatSimulation())}()}}},o.updateUserActivity=function(){var e=Date.now(),t=o.state.isUserActive;o.setState({lastUserActivity:e,isUserActive:!0}),t||(o.stopBreathingAnimation(),o.scaleTransitionStart=e,o.forceUpdate()),o.idleTimeout&&clearTimeout(o.idleTimeout),o.idleTimeout=setTimeout((function(){o.setState({isUserActive:!1}),o.startBreathingAnimation()}),5e3)},o.checkIdleAndReturnToDefault=function(){o.state.processingMutation||o.state.customQueryActive&&!o.state.isUserActive&&(o.setState({customQueryActive:!1,customQueryTimeout:null}),o.state.customQueryTimeout&&clearTimeout(o.state.customQueryTimeout),o.loadData(null,o.defaultQuery))},o.startIdleDetection=function(){["mousedown","mousemove","keypress","scroll","touchstart","click"].forEach((function(e){document.addEventListener(e,o.updateUserActivity,!0)})),o.idleCheckInterval=setInterval((function(){o.checkIdleAndReturnToDefault()}),2e3),o.updateUserActivity()},o.stopIdleDetection=function(){["mousedown","mousemove","keypress","scroll","touchstart","click"].forEach((function(e){document.removeEventListener(e,o.updateUserActivity,!0)})),o.idleCheckInterval&&(clearInterval(o.idleCheckInterval),o.idleCheckInterval=null),o.idleTimeout&&(clearTimeout(o.idleTimeout),o.idleTimeout=null)},o.addTimestampsToMutationQuery=function(e){if(!e||"string"!==typeof e)return e;var t=e.trim(),n=Date.now();if(!/(CREATE|MERGE|SET|DELETE|REMOVE|DETACH DELETE)/i.test(t))return e;if(o.isNFCOperation)return console.log("Skipping timestamp processing for NFC operation"),e;console.log("Processing mutation query with timestamps: ".concat(e));var a=e;return a=(a=(a=(a=(a=(a=(a=(a=a.replace(/CREATE\s*\(([^:]+):User\s*\{([^}]*)\}\)/gi,(function(e,t,o){var a=o.replace(/createdAt\s*:\s*[^,}]+/g,"").trim();a.endsWith(",")&&(a=a.slice(0,-1)),a="".concat(a,", createdAt: ").concat(n);var r=o.match(/name\s*:\s*['"]([^'"]+)['"]/);if(r){var i=r[1];return"MERGE (".concat(t,":User {name: '").concat(i,"'}) ON CREATE SET ").concat(t,".createdAt = ").concat(n)}return"CREATE (".concat(t,":User {").concat(a,"})")}))).replace(/MERGE\s*\(([^:]+):User\s*\{([^}]*)\}\)\s*ON CREATE SET\s*([^}]*)/gi,(function(e,t,o,a){if(!a.includes("createdAt")){var r=a.trim();return r.endsWith(",")&&(r=r.slice(0,-1)),r="".concat(r,", ").concat(t,".createdAt = ").concat(n),"MERGE (".concat(t,":User {").concat(o,"}) ON CREATE SET ").concat(r)}return e}))).replace(/CREATE\s*\(([^)]+)\)-\[:CONNECTED_TO\]->\(([^)]+)\)/gi,(function(e,t,o){return"CREATE (".concat(t,")-[r:CONNECTED_TO]->(").concat(o,") SET r.createdAt = ").concat(n)}))).replace(/CREATE\s*\(([^)]+)\)-\[([^:]+):CONNECTED_TO\]->\(([^)]+)\)/gi,(function(e,t,o,a){return"CREATE (".concat(t,")-[").concat(o,":CONNECTED_TO]->(").concat(a,") SET ").concat(o,".createdAt = ").concat(n)}))).replace(/MERGE\s*\(([^)]+)\)-\[:CONNECTED_TO\]->\(([^)]+)\)\s*ON CREATE SET\s*([^}]*)/gi,(function(e,t,o,a){if(!a.includes("createdAt")){var r=a.trim();return r.endsWith(",")&&(r=r.slice(0,-1)),r="".concat(r,", r.createdAt = ").concat(n),"MERGE (".concat(t,")-[r:CONNECTED_TO]->(").concat(o,") ON CREATE SET ").concat(r)}return e}))).replace(/MERGE\s*\(([^)]+)\)-\[([^:]+):CONNECTED_TO\]->\(([^)]+)\)\s*ON CREATE SET\s*([^}]*)/gi,(function(e,t,o,a,r){if(!r.includes("createdAt")){var i=r.trim();return i.endsWith(",")&&(i=i.slice(0,-1)),i="".concat(i,", ").concat(o,".createdAt = ").concat(n),"MERGE (".concat(t,")-[").concat(o,":CONNECTED_TO]->(").concat(a,") ON CREATE SET ").concat(i)}return e}))).replace(/MERGE\s*\(([^)]+)\)-\[:CONNECTED_TO\]->\(([^)]+)\)/gi,(function(e,t,o){return"MERGE (".concat(t,")-[r:CONNECTED_TO]->(").concat(o,") ON CREATE SET r.createdAt = ").concat(n)}))).replace(/MERGE\s*\(([^)]+)\)-\[([^:]+):CONNECTED_TO\]->\(([^)]+)\)(?!\s*ON CREATE)/gi,(function(e,t,o,a){return"MERGE (".concat(t,")-[").concat(o,":CONNECTED_TO]->(").concat(a,") ON CREATE SET ").concat(o,".createdAt = ").concat(n)})),console.log("Processed mutation query with timestamps: ".concat(a)),a},o.loadData=Object(g.a)(p.a.mark((function e(){var t,n,a,r,i,c,s,l,u,d,m,g,f,h,E,v,b,T,N,w,x,C,y,S=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=S.length>0&&void 0!==S[0]?S[0]:null,n=S.length>1&&void 0!==S[1]?S[1]:null,a=o.driver.session({database:"neo4j"}),c=!1,(i=n)?n!==o.defaultQuery&&(c=!0):null!==t||n||o.state.customQueryActive?(i=o.state.query,c=!0):i=o.defaultQuery,t&&o.pendingNFCNode&&t===o.pendingNFCNode&&(i=o.defaultQuery,c=!1),(s=/(CREATE|MERGE|SET|DELETE|REMOVE|DETACH DELETE)/i.test(i.trim()))&&(c=!1),i&&"string"===typeof i&&""!==i.trim()){e.next=12;break}return console.error("Invalid query:",i),e.abrupt("return");case 12:if(l=["MATCH","CREATE","MERGE","DELETE","SET","RETURN","WITH","UNWIND","CALL"],u=i.trim().toUpperCase(),l.some((function(e){return u.startsWith(e)}))){e.next=17;break}return e.abrupt("return");case 17:if(!/(DELETE|DETACH DELETE|REMOVE)/i.test(i.trim())){e.next=21;break}return alert("DELETE operations are not allowed for safety reasons. Please use other operations like CREATE, MERGE, or SET."),e.abrupt("return");case 21:return e.prev=21,d=i,s&&!o.isNFCOperation&&(d=o.addTimestampsToMutationQuery(i)),e.next=26,a.run(d);case 26:if(r=e.sent,!s){e.next=40;break}return o.setState({customQueryActive:!1,customQueryTimeout:null,processingMutation:!0,isUserActive:!0}),o.state.customQueryTimeout&&clearTimeout(o.state.customQueryTimeout),o.mutationReloadTimeout&&clearTimeout(o.mutationReloadTimeout),m=o.pendingNFCNode,o.isNFCOperation||o.state.processingMutation||o.loadData(m,o.defaultQuery),o.setState({processingMutation:!1}),o.mutationReloadTimeout=null,m&&!o.isNFCOperation?setTimeout((function(){o.focusOnNewNode(m,o.state.data),o.pendingNFCNode=null}),1500):o.isNFCOperation||(o.isNFCOperation=!1),setTimeout((function(){o.updateUserActivity()}),100),e.abrupt("return");case 40:c&&(o.setState({customQueryActive:!0}),o.state.customQueryTimeout&&clearTimeout(o.state.customQueryTimeout),o.updateUserActivity());case 41:e.next=49;break;case 43:return e.prev=43,e.t0=e.catch(21),console.error("Neo4j query failed:",e.t0),console.error("Query was:",i),o.setState({data:{nodes:[],links:[]}}),e.abrupt("return");case 49:return e.prev=49,a.close(),e.finish(49);case 52:g=new Map,f=[],r.records.forEach((function(e){if(e.has("source")&&e.has("target")&&e.get("source")&&e.get("target")&&"string"===typeof e.get("source")&&"string"===typeof e.get("target")){var t=e.get("source"),n=e.get("target");g.has(t)||g.set(t,{name:t,role:e.get("sourceRole"),location:e.get("sourceLocation"),website:e.get("sourceWebsite"),x:500*Math.random(),y:500*Math.random()}),g.has(n)||g.set(n,{name:n,role:e.get("targetRole"),location:e.get("targetLocation"),website:e.get("targetWebsite"),x:500*Math.random(),y:500*Math.random()}),g.has(t)&&g.has(n)?f.push({source:t,target:n}):console.warn("Invalid link skipped:",{source:t,target:n})}else e.keys.forEach((function(t){var n=e.get(t);if(n&&n.properties&&n.identity){var o=n.properties.name||"Node-".concat(n.identity.low);g.has(o)||g.set(o,{name:o,role:n.properties.role||"",location:n.properties.location||"",website:n.properties.website||"",x:500*Math.random(),y:500*Math.random()})}else if(n&&"object"===typeof n){var a=n.name||n.u_name||"Node-".concat(Date.now());g.has(a)||g.set(a,{name:a,role:n.role||n.u_role||"",location:n.location||n.u_location||"",website:n.website||n.u_website||"",x:500*Math.random(),y:500*Math.random()})}else if("string"===typeof n&&t.includes("name")){var r=n;g.has(r)||g.set(r,{name:r,role:e.get(t.replace("name","role"))||"",location:e.get(t.replace("name","location"))||"",website:e.get(t.replace("name","website"))||"",x:500*Math.random(),y:500*Math.random()})}}))})),h=Array.from(g.values()),E={nodes:h,links:f},o.pendingNFCNode&&h.find((function(e){return e.name===o.pendingNFCNode})),v=o.calculateDataHash(E),b=o.lastDataHash!==v,T=!o.isInitialLoad&&o.hasDataChanged(E,o.state.data),N=JSON.stringify(E)===JSON.stringify(o.state.data),localStorage.setItem("graphData",JSON.stringify(E)),w=Date.now(),x=w-o.lastUpdateTime,C=t&&o.pendingNFCNode&&t===o.pendingNFCNode,(b||T||null===o.lastDataHash||C)&&!N&&(x>o.updateDebounceTime||null===o.lastDataHash||C)&&o.updateCount<o.maxUpdatesPerCycle?(o.lastDataHash=v,o.lastUpdateTime=w,o.updateCount++,o.isInitialLoad&&(o.isInitialLoad=!1),y=o.isInitialLoad?null:t||o.state.latestNode,o.setState({data:E,latestNode:y,lastUpdateTime:b?w:o.state.lastUpdateTime},(function(){if(t)o.focusOnNewNode(t,E);else if(o.changedNodesFromPolling.length>0&&!o.isInitialLoad){var e=o.changedNodesFromPolling[0];o.focusOnPollingNode(e,E),o.pollingFocusTimeout&&clearTimeout(o.pollingFocusTimeout),o.pollingFocusTimeout=setTimeout((function(){o.setState({pollingFocusNode:null}),o.pollingFocusTimeout=null}),1e4),o.changedNodesFromPolling=[]}}))):(t&&o.state.latestNode!==t&&o.setState({latestNode:t}),o.updateCount=0);case 67:case"end":return e.stop()}}),e,null,[[21,43,49,52]])}))),o.focusOnNewNode=function(e,t){setTimeout((function(){return function n(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!(a>5)){var r=t.nodes.find((function(t){return t.name===e}));if(r)if(o.fgRef.current)try{o.fgRef.current.centerAt(r.x,r.y,1500),o.fgRef.current.zoom(1.25),o.setState({latestNode:e})}catch(i){setTimeout((function(){return n(a+1)}),500)}else setTimeout((function(){return n(a+1)}),500);else setTimeout((function(){return n(a+1)}),500)}}(1)}),1e3)},o.focusOnPollingNode=function(e,t){setTimeout((function(){return function n(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!(a>5)){var r=t.nodes.find((function(t){return t.name===e}));if(r)if(o.fgRef.current)try{o.fgRef.current.centerAt(r.x,r.y,1500),o.fgRef.current.zoom(1.25),o.setState({pollingFocusNode:e})}catch(i){setTimeout((function(){return n(a+1)}),500)}else setTimeout((function(){return n(a+1)}),500);else setTimeout((function(){return n(a+1)}),500)}}(1)}),1e3)},o.focusOnMultipleNodes=function(e,t){e&&0!==e.length&&o.focusOnNewNode(e[0],t)},o.calculateDataHash=function(e){var t=e.nodes.map((function(e){return"".concat(e.name,":").concat(e.role,":").concat(e.location,":").concat(e.website)})).sort().join("|"),n=e.links.map((function(e){var t="object"===typeof e.source?e.source.name:e.source,n="object"===typeof e.target?e.target.name:e.target;return"".concat(t,":").concat(n)})).sort().join("|");return"".concat(t,"|").concat(n)},o.hasDataChanged=function(e,t){if(!t||!t.nodes||!t.links)return!0;var n=[],a=!1;e.nodes.length===t.nodes.length&&e.links.length===t.links.length||(a=!0);var r,i=new Map(t.nodes.map((function(e){return[e.name,e]}))),c=Object(d.a)(e.nodes);try{for(c.s();!(r=c.n()).done;){var s=r.value,l=i.get(s.name);l&&l.role===s.role&&l.location===s.location&&l.website===s.website||(n.push(s.name),a=!0)}}catch(E){c.e(E)}finally{c.f()}var u,m=new Set(t.links.map((function(e){var t="object"===typeof e.source?e.source.name:e.source,n="object"===typeof e.target?e.target.name:e.target;return"".concat(t,":").concat(n)}))),p=Object(d.a)(e.links);try{for(p.s();!(u=p.n()).done;){var g=u.value,f="object"===typeof g.source?g.source.name:g.source,h="object"===typeof g.target?g.target.name:g.target;m.has("".concat(f,":").concat(h))||(n.includes(f)||n.push(f),n.includes(h)||n.push(h),a=!0)}}catch(E){p.e(E)}finally{p.f()}return a&&n.length>0&&(o.changedNodesFromPolling=n),a},o.startPolling=function(){o.pollingInterval&&clearInterval(o.pollingInterval),o.setState({isPolling:!0}),o.pollingInterval=setInterval((function(){if(!document.hidden){if(o.state.customQueryActive||o.state.processingMutation||o.isNFCOperation)return;o.loadData(null,o.defaultQuery)}}),5e3),o.updateCountResetInterval&&clearInterval(o.updateCountResetInterval),o.updateCountResetInterval=setInterval((function(){o.updateCount=0}),3e4)},o.stopPolling=function(){o.pollingInterval&&(clearInterval(o.pollingInterval),o.pollingInterval=null),o.updateCountResetInterval&&(clearInterval(o.updateCountResetInterval),o.updateCountResetInterval=null),o.setState({isPolling:!1})},o.connectWebSocket=function(){o.startPolling()},o.disconnectWebSocket=function(){o.websocket&&(o.websocket.close(),o.websocket=null),o.setState({wsConnected:!1,useWebSocket:!1})},o.addNodeNFC=function(){var e=Object(g.a)(p.a.mark((function e(t,n){var a,r,i,c,s,l,u,d,m,g,f,h,E,v,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(a=function(e){return e?e.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})).join(" "):e})(t),i=a(n),o.isNFCOperation=!0,o.pendingNFCNode&&(o.pendingNFCNode=null),c=o.driver.session({database:"neo4j"}),e.prev=6,s=Date.now(),e.next=10,c.run("MATCH (u:User {name: $user}) RETURN u.name as name",{user:r});case 10:if(l=e.sent,u=r,!1,l.records.length>0?(console.log('Node with name "'.concat(r,'" already exists, using existing node')),!0,u=r):console.log('Creating new node with name "'.concat(r,'"')),o.isNFCOperation&&o.pendingNFCNode){e.next=33;break}return e.next=17,c.run("MATCH (u:User {name: $user})\n           RETURN count(u) as count",{user:r});case 17:if(d=e.sent,!((m=d.records[0].get("count").toNumber())>1)){e.next=33;break}return console.log("Found ".concat(m,' duplicate nodes for "').concat(r,'", merging them...')),e.next=23,c.run("MATCH (u:User {name: $user})\n             RETURN u.role as role, u.location as location, u.website as website\n             ORDER BY u.role DESC, u.location DESC, u.website DESC",{user:r});case 23:return g=e.sent,f="",h="",E="",g.records.forEach((function(e){var t=e.get("role"),n=e.get("location"),o=e.get("website");t&&""!==t&&(f=t),n&&""!==n&&(h=n),o&&""!==o&&(E=o)})),e.next=30,c.run("MATCH (u:User {name: $user})\n             DETACH DELETE u",{user:r});case 30:return e.next=32,c.run("CREATE (u:User {name: $user, role: $role, location: $location, website: $website, createdAt: $createdAt})",{user:r,role:f,location:h,website:E,createdAt:s});case 32:console.log('Merged duplicate nodes for "'.concat(r,'" with properties:'),{bestRole:f,bestLocation:h,bestWebsite:E,timestamp:s});case 33:return e.next=35,c.run("MERGE (u:User {name: $user}) \n         ON CREATE SET u.role = '', \n                       u.location = '', \n                       u.website = '',\n                       u.createdAt = $timestamp\n\n         MERGE (nfc:User {name: $nfcUser}) \n         ON CREATE SET nfc.role = '', \n                       nfc.location = '', \n                       nfc.website = '',\n                       nfc.createdAt = $timestamp\n\n         MERGE (u)-[r:CONNECTED_TO]->(nfc) \n         ON CREATE SET r.createdAt = $timestamp\n        ",{user:r,nfcUser:i,timestamp:s});case 35:return console.log("Created/connected nodes with timestamp: ".concat(s," for ").concat(r," -> ").concat(i)),o.pendingNFCNode=u,e.next=39,o.loadData(u,o.defaultQuery);case 39:v=0,b=function e(){var t=o.state.data.nodes.find((function(e){return e.name===u}));v++,t?(o.focusOnNewNode(u,o.state.data),o.pendingNFCNode=null,o.isNFCOperation=!1,o.refreshTimelineStats(),o.setState({nfcNodeForAutoPopup:u})):v<10?setTimeout(e,500):(console.error("Failed to find node in state after multiple attempts"),o.pendingNFCNode=null,o.isNFCOperation=!1)},setTimeout(b,1e3),e.next=49;break;case 44:e.prev=44,e.t0=e.catch(6),console.error("Error adding user:",e.t0),o.pendingNFCNode=null,o.isNFCOperation=!1;case 49:return e.prev=49,c.close(),e.finish(49);case 52:case"end":return e.stop()}}),e,null,[[6,44,49,52]])})));return function(t,n){return e.apply(this,arguments)}}(),o.handleChange=function(e){var t=e.target.value;if(t&&""!==t.trim()){var n=t.trim().toUpperCase();["MATCH","CREATE","MERGE","DELETE","SET","RETURN","WITH","UNWIND","CALL"].some((function(e){return n.startsWith(e)}))&&o.setState({query:t})}else o.setState({query:o.defaultQuery})},o.resetQuery=function(){o.setState({query:o.defaultQuery,customQueryActive:!1,customQueryTimeout:null,processingMutation:!1}),o.state.customQueryTimeout&&clearTimeout(o.state.customQueryTimeout)},o.validateAndCleanQuery=function(){var e=o.state.query;if(e&&"string"===typeof e&&""!==e.trim()){var t=e.trim().toUpperCase();["MATCH","CREATE","MERGE","DELETE","SET","RETURN","WITH","UNWIND","CALL"].some((function(e){return t.startsWith(e)}))||o.setState({query:o.defaultQuery})}else o.setState({query:o.defaultQuery})},o.onNfcPopupTriggered=function(){o.setState({nfcNodeForAutoPopup:null})},o.toggleTimelineMode=Object(g.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.state.timelineMode){e.next=9;break}return e.next=3,o.getTimelineStats();case 3:t=e.sent,o.stopBreathingAnimation(),n=t||{earliest:new Date(Date.now()-864e5),latest:new Date},o.setState((function(e){return{timelineMode:!0,timelineDate:n.latest,timelineData:e.data,timelineStats:n}})),e.next=11;break;case 9:o.setState({timelineMode:!1,timelineDate:null,timelineData:null,timelineStats:null}),o.state.isUserActive||o.startBreathingAnimation();case 11:case"end":return e.stop()}}),e)}))),o.loadTimelineData=function(){var e=Object(g.a)(p.a.mark((function e(t){var n,a,r,i,c,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.driver){e.next=2;break}return e.abrupt("return");case 2:return n=o.driver.session(),e.prev=3,a=t.getTime(),e.next=7,n.run("MATCH (u:User)\n         WHERE u.createdAt IS NOT NULL AND u.createdAt <= $timestamp\n         OPTIONAL MATCH (u)-[r:CONNECTED_TO]->(v:User)\n         WHERE v.createdAt IS NOT NULL AND v.createdAt <= $timestamp\n         AND r.createdAt IS NOT NULL AND r.createdAt <= $timestamp\n         RETURN u.name AS source, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite,\n                v.name AS target, v.role AS targetRole, v.location AS targetLocation, v.website AS targetWebsite",{timestamp:a});case 7:r=e.sent,i=new Set,c=[],r.records.forEach((function(e){var t=e.get("source"),n=e.get("target"),o=e.get("sourceRole"),a=e.get("targetRole"),r=e.get("sourceLocation"),s=e.get("targetLocation"),l=e.get("sourceWebsite"),u=e.get("targetWebsite");i.add(t),n&&(i.add(n),c.push({source:t,target:n,sourceRole:o,targetRole:a,sourceLocation:r,targetLocation:s,sourceWebsite:l,targetWebsite:u}))})),s={nodes:Array.from(i).map((function(e){return{name:e}})),links:c},o.setState({timelineData:s,timelineDate:t}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error("Error loading timeline data:",e.t0);case 18:return e.prev=18,n.close(),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})));return function(t){return e.apply(this,arguments)}}(),o.updateTimelineDate=function(e){o.loadTimelineData(e)},o.getTimelineStats=Object(g.a)(p.a.mark((function e(){var t,n,a,r,i,c,s,l,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.driver){e.next=2;break}return e.abrupt("return",null);case 2:return t=o.driver.session(),e.prev=3,e.next=6,t.run("MATCH ()-[r:CONNECTED_TO]->()\n         WHERE r.createdAt IS NOT NULL\n         RETURN min(r.createdAt) as earliest, max(r.createdAt) as latest");case 6:if(!((n=e.sent).records.length>0)){e.next=16;break}return a=n.records[0],r=a.get("earliest"),i=a.get("latest"),s=(c=function(e){if(!e)return null;var t=Number(e),n=new Date("1970-01-01").getTime(),o=new Date("2100-01-01").getTime();if(t>=n&&t<=o)return new Date(t);var a=1e3*t;return a>=n&&a<=o?new Date(a):null})(r),l=c(i),u={earliest:s||new Date(Date.now()-864e5),latest:l||new Date},e.abrupt("return",u);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),console.error("Error getting timeline stats:",e.t0);case 21:return e.prev=21,t.close(),e.finish(21);case 24:return e.abrupt("return",null);case 25:case"end":return e.stop()}}),e,null,[[3,18,21,24]])}))),o.resetToCurrentTime=function(){o.setState({timelineMode:!1,timelineDate:null,timelineData:null})},o.refreshTimelineStats=Object(g.a)(p.a.mark((function e(){var t,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.state.timelineMode){e.next=8;break}return e.next=3,o.getTimelineStats();case 3:n=e.sent,a=o.state.timelineDate,n&&o.state.timelineDate&&(o.state.timelineDate.getTime()>n.latest.getTime()?a=n.latest:o.state.timelineDate.getTime()<n.earliest.getTime()&&(a=n.earliest)),o.setState({timelineStats:n,timelineDate:a}),a&&a.getTime()!==(null===(t=o.state.timelineDate)||void 0===t?void 0:t.getTime())&&o.loadTimelineData(a);case 8:case"end":return e.stop()}}),e)}))),o.driver=r,o.fgRef=a.a.createRef(),o.defaultData={nodes:[],links:[]},o.state={data:o.defaultData,query:"MATCH (u:User)-[r:CONNECTED_TO]->(v:User) \n          RETURN u.name AS source, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite, \n      v.name AS target, v.role AS targetRole, v.location AS targetLocation, v.website AS targetWebsite",latestNode:null,pollingFocusNode:null,lastUpdateTime:null,isPolling:!1,useWebSocket:!1,wsConnected:!1,customQueryActive:!1,customQueryTimeout:null,processingMutation:!1,lastUserActivity:Date.now(),isUserActive:!0,nfcNodeForAutoPopup:null,timelineMode:!1,timelineDate:null,timelineData:null},o.defaultQuery="MATCH (u:User)-[r:CONNECTED_TO]->(v:User) \n        RETURN u.name AS source, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite, \n        v.name AS target, v.role AS targetRole, v.location AS targetLocation, v.website AS targetWebsite",o.lastDataHash=null,o.pollingInterval=null,o.websocket=null,o.lastUpdateTime=0,o.updateDebounceTime=2e3,o.updateCount=0,o.maxUpdatesPerCycle=3,o.mutationReloadTimeout=null,o.idleTimeout=null,o.idleCheckInterval=null,o.isNFCOperation=!1,o.changedNodesFromPolling=[],o.isInitialLoad=!0,o.pollingFocusTimeout=null,o.breathingAnimation=null,o.breathingState="expanded",o.breathingInterval=null,o.scaleTransitionStart=null,o.scaleTransitionDuration=1e3,o}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.validateAndCleanQuery(),x(this.driver),this.loadData(),this.connectWebSocket(),this.handleVisibilityChange=function(){},document.addEventListener("visibilitychange",this.handleVisibilityChange),this.startIdleDetection()}},{key:"componentWillUnmount",value:function(){this.stopPolling(),this.disconnectWebSocket(),this.state.customQueryTimeout&&clearTimeout(this.state.customQueryTimeout),this.mutationReloadTimeout&&(clearTimeout(this.mutationReloadTimeout),this.mutationReloadTimeout=null),this.setState({processingMutation:!1}),this.pollingFocusTimeout&&(clearTimeout(this.pollingFocusTimeout),this.pollingFocusTimeout=null),this.stopBreathingAnimation(),this.stopIdleDetection(),this.handleVisibilityChange&&document.removeEventListener("visibilitychange",this.handleVisibilityChange)}},{key:"render",value:function(){return a.a.createElement(b.a,null,a.a.createElement("div",null,a.a.createElement(T.c,null,a.a.createElement(T.a,{path:"/:username",element:a.a.createElement(y,{addNode:this.addNodeNFC})}),a.a.createElement(T.a,{path:"/",element:a.a.createElement(S,{data:this.state.data,handleChange:this.handleChange,loadData:this.loadData,fgRef:this.fgRef,latestNode:this.state.latestNode,pollingFocusNode:this.state.pollingFocusNode,driver:this.driver,processingMutation:this.state.processingMutation,updateUserActivity:this.updateUserActivity,isUserActive:this.state.isUserActive,scaleTransitionStart:this.scaleTransitionStart,scaleTransitionDuration:this.scaleTransitionDuration,nfcNodeForAutoPopup:this.state.nfcNodeForAutoPopup,onNfcPopupTriggered:this.onNfcPopupTriggered,timelineMode:this.state.timelineMode,timelineDate:this.state.timelineDate,timelineData:this.state.timelineData,timelineStats:this.state.timelineStats,toggleTimelineMode:this.toggleTimelineMode,loadTimelineData:this.loadTimelineData,updateTimelineDate:this.updateTimelineDate,resetToCurrentTime:this.resetToCurrentTime})}))))}}]),n}(a.a.Component),y=function(e){var t=e.addNode,n=Object(T.n)(),o=Object(T.r)().username;return a.a.useEffect((function(){(function(){var e=Object(g.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="User-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),console.log("NFC Trigger: Starting NFC operation for ".concat(o," with visitor ").concat(n)),e.prev=2,e.next=5,t(n,o);case 5:console.log("NFC Trigger: addNode completed successfully"),e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(2),console.error("NFC Trigger: Error adding user:",e.t0),e.abrupt("return");case 12:setTimeout((function(){window.location.assign("/MITNet/#/")}),2e3);case 13:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(){return e.apply(this,arguments)}})()()}),[n,o]),a.a.createElement("div",{style:{textAlign:"center",padding:"20px",fontSize:"16px",color:"red"}},"Adding you to ",o,"'s network...")},S=function(e){var t,n,r,i,d,m,f=e.data,h=e.handleChange,E=e.loadData,v=e.fgRef,b=e.latestNode,T=e.pollingFocusNode,w=e.driver,x=e.processingMutation,C=e.updateUserActivity,y=e.isUserActive,S=e.scaleTransitionStart,A=e.scaleTransitionDuration,k=e.nfcNodeForAutoPopup,O=e.onNfcPopupTriggered,R=e.timelineMode,D=e.timelineDate,L=e.timelineData,M=e.timelineStats,U=e.toggleTimelineMode,j=e.loadTimelineData,I=e.updateTimelineDate,W=(e.resetToCurrentTime,Object(o.useState)("")),H=Object(u.a)(W,2),_=H[0],F=H[1],P=Object(o.useState)(null),$=Object(u.a)(P,2),B=$[0],z=$[1],Q=Object(o.useState)(null),q=Object(u.a)(Q,2),G=q[0],K=q[1],V=Object(o.useState)(null),J=Object(u.a)(V,2),Z=J[0],X=J[1],Y=Object(o.useState)(null),ee=Object(u.a)(Y,2),te=ee[0],ne=ee[1],oe=Object(o.useState)(null),ae=Object(u.a)(oe,2),re=ae[0],ie=ae[1],ce=Object(o.useState)([]),se=Object(u.a)(ce,2),le=se[0],ue=se[1],de=Object(o.useState)(null),me=Object(u.a)(de,2),pe=me[0],ge=me[1],fe=Object(o.useState)(!1),he=Object(u.a)(fe,2),Ee=he[0],ve=he[1],be=Object(o.useState)(""),Te=Object(u.a)(be,2),Ne=Te[0],we=Te[1],xe=Object(o.useState)(""),Ce=Object(u.a)(xe,2),ye=Ce[0],Se=Ce[1],Ae=Object(o.useState)(""),ke=Object(u.a)(Ae,2),Oe=ke[0],Re=ke[1],De=Object(o.useState)(!1),Le=Object(u.a)(De,2),Me=Le[0],Ue=Le[1],je=Object(o.useState)(!1),Ie=Object(u.a)(je,2),We=Ie[0],He=Ie[1],_e=Object(o.useState)(""),Fe=Object(u.a)(_e,2),Pe=Fe[0],$e=Fe[1],Be=Object(o.useState)(null),ze=Object(u.a)(Be,2),Qe=ze[0],qe=ze[1],Ge=Object(o.useState)({}),Ke=Object(u.a)(Ge,2),Ve=Ke[0],Je=Ke[1],Ze=Object(o.useState)(!1),Xe=Object(u.a)(Ze,2),Ye=Xe[0],et=Xe[1],tt=Object(o.useState)(null),nt=Object(u.a)(tt,2),ot=nt[0],at=nt[1],rt=Object(o.useState)(null),it=Object(u.a)(rt,2),ct=it[0],st=it[1],lt=Object(o.useState)(null),ut=Object(u.a)(lt,2),dt=ut[0],mt=ut[1],pt=Object(o.useState)(!1),gt=Object(u.a)(pt,2),ft=gt[0],ht=gt[1];Object(o.useEffect)((function(){b&&(ie("latestNode"),dt&&(clearTimeout(dt),mt(null)),ht(!1))}),[b,dt]),Object(o.useEffect)((function(){if(k&&f.nodes.length>0){var e=f.nodes.find((function(e){return e.name===k}));e&&(Ue(!0),Se(""),X(e.name),ne(e.name),ie("latestNode"),"function"===typeof O&&O())}}),[k,f.nodes]),Object(o.useEffect)((function(){v.current&&f.nodes.length>0&&!re&&setTimeout((function(){v.current&&v.current.zoom(2,1e3)}),1e3)}),[f.nodes,v,re]);!function(){if(!b||!f)return new Set;var e=new Set;e.add(b),f.links.forEach((function(t){t.source===b&&e.add(t.target),t.target===b&&e.add(t.source)}))}();var Et=function(e,t){if(!e||!f)return new Set;for(var n=new Set,o=new Set([e]),a=function(e){var t=new Set;f.links.forEach((function(e){var a="object"===typeof e.source?e.source.name:e.source,r="object"===typeof e.target?e.target.name:e.target;o.forEach((function(e){e!==a||n.has(r)||t.add(r),e!==r||n.has(a)||t.add(a)}))})),t.forEach((function(e){return n.add(e)})),o.forEach((function(e){return n.add(e)})),o=t},r=0;r<t;r++)a();return n.add(e),n},vt=Z||te||b,bt="search"===re?"search":"click"===re?te:"latestNode"===re?b:"mutation"===re?le[0]:null,Tt=Et(vt,1);_&&_.trim()&&f.nodes.filter((function(e){return e.name.toLowerCase().includes(_.toLowerCase())||e.location&&e.location.toLowerCase().includes(_.toLowerCase())||e.role&&e.role.toLowerCase().includes(_.toLowerCase())||e.website&&e.website.toLowerCase().includes(_.toLowerCase())})).forEach((function(e){Et(e.name,1).forEach((function(e){return Tt.add(e)}))}));"mutation"===re&&le.length>0&&le.forEach((function(e){Et(e,0).forEach((function(e){return Tt.add(e)}))}));var Nt="search"===re?function(){var e=f.nodes.filter((function(e){return e.name.toLowerCase().includes(_.toLowerCase())||e.location&&e.location.toLowerCase().includes(_.toLowerCase())||e.role&&e.role.toLowerCase().includes(_.toLowerCase())||e.website&&e.website.toLowerCase().includes(_.toLowerCase())})),t=new Set;return e.forEach((function(e){Et(e.name,1).forEach((function(e){return t.add(e)}))})),t}():"mutation"===re?function(){var e=new Set;return le.forEach((function(t){Et(t,1).forEach((function(t){return e.add(t)}))})),e}():Et(bt,1);Object(o.useEffect)((function(){if(!ft&&v.current&&re)if(dt&&(clearTimeout(dt),mt(null)),ht(!0),Nt.size>0){var e=function(){var e=f.nodes.filter((function(e){return Nt.has(e.name)}));if(0!==e.length){var t=e.map((function(e){return e.x})),n=e.map((function(e){return e.y})),o=Math.min.apply(Math,Object(l.a)(t)),a=Math.max.apply(Math,Object(l.a)(t)),r=Math.min.apply(Math,Object(l.a)(n)),i=Math.max.apply(Math,Object(l.a)(n)),c=(o+a)/2,s=(r+i)/2,u=a-o,d=i-r,m=Math.min((window.innerWidth-100)/u,(window.innerHeight-100)/d,2);v.current.centerAt(c,s,1e3),v.current.zoom(m,1e3);var p=setTimeout((function(){mt(null),ht(!1)}),1e3);mt(p)}};"latestNode"===re||"mutation"===re?setTimeout(e,1e3):e()}else ht(!1)}),[re,te,b,_,le]),Object(o.useEffect)((function(){return function(){dt&&clearTimeout(dt),ht(!1)}}),[dt]);var wt=function(){var e=Object(g.a)(p.a.mark((function e(t){var n,o,a,r,i,c,s,l,u,d,m,g,f,v,b,T,N,x,C,y,S,A,k;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("https://flowise-hako.onrender.com/api/v1/prediction/29e305b3-c569-4676-a454-1c4fdc380c69",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:_})});case 4:return n=e.sent,e.next=7,n.json();case 7:if(o=e.sent,a=(a=o.text||o.query||"").replace(/```cypher\s*/gi,"").replace(/```\s*$/gi,"").replace(/^```\s*/gi,"").trim(),r=_.toLowerCase(),i=function(){console.log("Checking for node report request:",_);for(var e=0,t=[/report.*(?:for|about|on)\s+([A-Za-z\s]+)/i,/(?:generate|create|show)\s+(?:a\s+)?report.*(?:for|about|on)\s+([A-Za-z\s]+)/i,/(?:analysis|summary)\s+(?:for|about|on)\s+([A-Za-z\s]+)/i,/([A-Za-z\s]+)\s+(?:report|analysis|summary)/i,/(?:report|analysis|summary)\s+for\s+([A-Za-z\s]+)/i];e<t.length;e++){var n=t[e],o=r.match(n);if(o&&o[1]){var a=o[1].trim();if(a.length>2&&!["the","and","or","for","about","on","generate","create","show","analysis","summary","report","network","comprehensive","full"].includes(a.toLowerCase())&&(a.includes(" ")||a.length>3))return console.log("Node report detected for:",a),a}}return null}(),c=["report","analysis","summary","network analysis","bridge analysis","top connectors","network health","generate report","comprehensive report","full analysis","network report","bridge report","connector analysis"].some((function(e){return r.includes(e)})),s=![/show me/i,/display/i,/visualize/i,/find/i,/search for/i,/look for/i,/get/i,/bring up/i,/open/i].some((function(e){return e.test(r)}))&&(!![/how many/i,/how much/i,/what is the (count|number|total)/i,/what are the (count|numbers|totals)/i,/count of/i,/total number of/i,/how many (artists|users|people|connections|relationships)/i,/what (roles|locations|websites) (exist|are there)/i,/which (roles|locations|websites)/i,/what is the most common/i,/what is the average/i,/how many people are (in|from)/i].some((function(e){return e.test(r)}))||["how many","how much","what is","what are","when","where","why","who","which","how","what"].some((function(e){return r.includes(e)}))),!i){e.next=50;break}return e.prev=15,l=i,console.log("Generating node report for:",l),u=w.session({database:"neo4j"}),"\n                  MATCH (u:User)\n                  WHERE toLower(u.name) = toLower($nodeName)\n                  OPTIONAL MATCH (u)-[r:CONNECTED_TO]->(v:User)\n                  RETURN u.name AS sourceName, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite,\n                         v.name AS targetName, v.role AS targetRole, v.location AS targetLocation, v.website AS targetWebsite,\n                         r.note AS connectionNote, r.createdAt AS connectionTime\n                  UNION\n                  MATCH (v:User)-[r:CONNECTED_TO]->(u:User)\n                  WHERE toLower(u.name) = toLower($nodeName)\n                  RETURN v.name AS sourceName, v.role AS sourceRole, v.location AS sourceLocation, v.website AS sourceWebsite,\n                         u.name AS targetName, u.role AS targetRole, u.location AS targetLocation, u.website AS targetWebsite,\n                         r.note AS connectionNote, r.createdAt AS connectionTime\n                  UNION\n                  MATCH (u:User)\n                  WHERE toLower(u.name) = toLower($nodeName)\n                  AND NOT EXISTS((u)-[:CONNECTED_TO]->())\n                  AND NOT EXISTS(()-[:CONNECTED_TO]->(u))\n                  RETURN u.name AS sourceName, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite,\n                         null AS targetName, null AS targetRole, null AS targetLocation, null AS targetWebsite,\n                         null AS connectionNote, null AS connectionTime\n                ",e.next=22,u.run("\n                  MATCH (u:User)\n                  WHERE toLower(u.name) = toLower($nodeName)\n                  OPTIONAL MATCH (u)-[r:CONNECTED_TO]->(v:User)\n                  RETURN u.name AS sourceName, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite,\n                         v.name AS targetName, v.role AS targetRole, v.location AS targetLocation, v.website AS targetWebsite,\n                         r.note AS connectionNote, r.createdAt AS connectionTime\n                  UNION\n                  MATCH (v:User)-[r:CONNECTED_TO]->(u:User)\n                  WHERE toLower(u.name) = toLower($nodeName)\n                  RETURN v.name AS sourceName, v.role AS sourceRole, v.location AS sourceLocation, v.website AS sourceWebsite,\n                         u.name AS targetName, u.role AS targetRole, u.location AS targetLocation, u.website AS targetWebsite,\n                         r.note AS connectionNote, r.createdAt AS connectionTime\n                  UNION\n                  MATCH (u:User)\n                  WHERE toLower(u.name) = toLower($nodeName)\n                  AND NOT EXISTS((u)-[:CONNECTED_TO]->())\n                  AND NOT EXISTS(()-[:CONNECTED_TO]->(u))\n                  RETURN u.name AS sourceName, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite,\n                         null AS targetName, null AS targetRole, null AS targetLocation, null AS targetWebsite,\n                         null AS connectionNote, null AS connectionTime\n                ",{nodeName:l});case 22:if(d=e.sent,console.log("Node query result:",d.records.length,"records"),d.records.length>0&&console.log("First record:",d.records[0].toObject()),0!==d.records.length){e.next=37;break}return console.log("No exact match found, trying fuzzy search..."),"\n                    MATCH (u:User)\n                    WHERE toLower(u.name) CONTAINS toLower($nodeName)\n                    RETURN u.name AS name, u.role AS role, u.location AS location\n                    LIMIT 5\n                  ",e.next=30,u.run("\n                    MATCH (u:User)\n                    WHERE toLower(u.name) CONTAINS toLower($nodeName)\n                    RETURN u.name AS name, u.role AS role, u.location AS location\n                    LIMIT 5\n                  ",{nodeName:l});case 30:if(!((m=e.sent).records.length>0)){e.next=37;break}return g=m.records.map((function(e){return e.get("name")})).join(", "),e.next=35,u.close();case 35:return Mt('No exact match found for "'.concat(l,'". Did you mean one of these?\n\n').concat(g,"\n\nPlease try with the exact name."),"Name Not Found: ".concat(l)),e.abrupt("return");case 37:return e.next=39,u.close();case 39:f=Lt(d,l,_),Mt(f,"Node Analysis: ".concat(l)),setTimeout((function(){F("")}),1e4),e.next=48;break;case 44:e.prev=44,e.t0=e.catch(15),console.error("Error generating node report:",e.t0),Mt("Sorry, I couldn't generate a report for that person. Please check the name and try again.",_);case 48:e.next=104;break;case 50:if(!c){e.next=69;break}return e.prev=51,v=w.session({database:"neo4j"}),e.next=55,v.run(a);case 55:return b=e.sent,e.next=58,v.close();case 58:T=Dt(b,_),Mt(T,_),setTimeout((function(){F("")}),1e4),e.next=67;break;case 63:e.prev=63,e.t1=e.catch(51),console.error("Error generating report:",e.t1),Mt("Sorry, I couldn't generate the report. Please try again.",_);case 67:e.next=104;break;case 69:if(!s){e.next=88;break}return e.prev=70,N=w.session({database:"neo4j"}),e.next=74,N.run(a);case 74:return x=e.sent,e.next=77,N.close();case 77:C=Ot(_,x,a),Rt(C,_),setTimeout((function(){F("")}),5e3),e.next=86;break;case 82:e.prev=82,e.t2=e.catch(70),console.error("Error executing analytical query:",e.t2),Rt("Sorry, I couldn't analyze that question. Please try rephrasing it.",_);case 86:e.next=104;break;case 88:return F(a),h({target:{value:a}}),e.next=92,E(null,a);case 92:if(!/(CREATE|MERGE|SET|DELETE|REMOVE|DETACH DELETE)/i.test(a.trim())){e.next=103;break}return y=[],a.includes("DELETE")?(S=a.match(/\{name:\s*['"]([^'"]+)['"]\}/g))&&(y=S.map((function(e){var t=e.match(/name:\s*['"]([^'"]+)['"]/);return t?t[1]:null})).filter(Boolean)):a.includes("SET")?(A=a.match(/MATCH\s*\([^)]*\{name:\s*['"]([^'"]+)['"][^}]*\}\)/i))&&(y=[A[1]]):(k=a.match(/\{([^}]+)\}/g),y=k?k.map((function(e){var t=e.match(/name:\s*['"]([^'"]+)['"]/);return t?t[1]:null})).filter(Boolean):[]),ue(y),ie("mutation"),dt&&(clearTimeout(dt),mt(null)),ht(!1),"\n                  MATCH (u:User)-[r:CONNECTED_TO]->(v:User)\n                  RETURN u.name AS source, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite, \n                         v.name AS target, v.role AS targetRole, v.location AS targetLocation, v.website AS targetWebsite\n                ",e.next=103,E(null,"\n                  MATCH (u:User)-[r:CONNECTED_TO]->(v:User)\n                  RETURN u.name AS source, u.role AS sourceRole, u.location AS sourceLocation, u.website AS sourceWebsite, \n                         v.name AS target, v.role AS targetRole, v.location AS targetLocation, v.website AS targetWebsite\n                ");case 103:setTimeout((function(){F("")}),3e3);case 104:e.next=109;break;case 106:e.prev=106,e.t3=e.catch(1),console.error("Flowise call failed:",e.t3);case 109:case"end":return e.stop()}}),e,null,[[1,106],[15,44],[51,63],[70,82]])})));return function(t){return e.apply(this,arguments)}}(),xt=function(){var e=Object(g.a)(p.a.mark((function e(t){var n,o,a,r,i,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n="object"===typeof t.source?t.source.name:t.source,o="object"===typeof t.target?t.target.name:t.target,console.log("Link clicked: ".concat(n," -> ").concat(o)),a=w.session(),e.prev=6,e.next=9,a.run("MATCH (source:User {name: $sourceName})-[r:CONNECTED_TO]->(target:User {name: $targetName})\n               RETURN r.note as note, source.name as sourceName, target.name as targetName",{sourceName:n,targetName:o});case 9:(r=e.sent).records.length>0&&(i=r.records[0],c=i.get("note"),qe(t),Je({sourceName:n,targetName:o,note:c}),console.log("Relationship data: ".concat(n," -> ").concat(o,", Note: ").concat(c))),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error("Error fetching relationship data:",e.t0);case 16:return e.prev=16,a.close(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[6,13,16,19]])})));return function(t){return e.apply(this,arguments)}}(),Ct=function(){var e=Object(g.a)(p.a.mark((function e(t){var n,o,a,r,i,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return st(null),e.abrupt("return");case 3:return n="object"===typeof t.source?t.source.name:t.source,o="object"===typeof t.target?t.target.name:t.target,a=w.session(),e.prev=6,e.next=9,a.run("MATCH (source:User {name: $sourceName})-[r:CONNECTED_TO]->(target:User {name: $targetName})\n               RETURN r.note as note, source.name as sourceName, target.name as targetName",{sourceName:n,targetName:o});case 9:(r=e.sent).records.length>0&&(i=r.records[0],c=i.get("note"),st({link:t,sourceName:n,targetName:o,note:c})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error("Error fetching relationship data:",e.t0);case 16:return e.prev=16,a.close(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[6,13,16,19]])})));return function(t){return e.apply(this,arguments)}}(),yt=function(e){var t=e.target,n=t.name,o=t.value;K((function(e){return Object(s.a)({},e,Object(c.a)({},n,o))}))},St=function(){var e=Object(g.a)(p.a.mark((function e(){var t,n,o,a,r,i,c,s,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B&&Ne.trim()){e.next=2;break}return e.abrupt("return");case 2:if(t=w.session(),e.prev=3,!Ye){e.next=16;break}if(!ot){e.next=10;break}n=ot.source,o=ot.target,e.next=14;break;case 10:return e.next=12,t.run("MATCH (source:User)-[r:CONNECTED_TO]->(target:User {name: $holderName})\n                   RETURN source.name as sourceName, target.name as targetName\n                   ORDER BY source.name DESC\n                   LIMIT 1",{holderName:B.name});case 12:(a=e.sent).records.length>0&&(r=a.records[0],n=r.get("sourceName"),o=r.get("targetName"));case 14:e.next=21;break;case 16:return e.next=18,t.run("MATCH (existing:User {name: $existingName})-[r:CONNECTED_TO]->(holder:User)\n                 RETURN holder.name as holderName",{existingName:B.name});case 18:c=e.sent,(s=null===(i=c.records[0])||void 0===i?void 0:i.get("holderName"))&&(n=B.name,o=s);case 21:if(!n||!o){e.next=26;break}return e.next=24,t.run("MATCH (source:User {name: $sourceName})-[r:CONNECTED_TO]->(target:User {name: $targetName})\n                 SET r.note = $note\n                 RETURN r.note as updatedNote",{sourceName:n,targetName:o,note:Ne.trim()});case 24:(l=e.sent).records.length>0&&l.records[0].get("updatedNote");case 26:z(null),we(""),$e(""),et(!1),at(null),e.next=36;break;case 33:e.prev=33,e.t0=e.catch(3),console.error("Error saving relationship note:",e.t0);case 36:return e.prev=36,t.close(),e.finish(36);case 39:case"end":return e.stop()}}),e,null,[[3,33,36,39]])})));return function(){return e.apply(this,arguments)}}(),At=function(){var e=Object(g.a)(p.a.mark((function e(){var t,n,o,a,r,i,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ye.trim()){e.next=2;break}return e.abrupt("return");case 2:return t=function(e){return e?e.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})).join(" "):e}(ye.trim()),$e(t),n=w.session(),e.prev=6,e.next=9,n.run("MATCH (u:User {name: $name}) RETURN u",{name:t});case 9:if(!((o=e.sent).records.length>0)){e.next=41;break}return console.log('Node "'.concat(t,'" exists, merging visitor into existing node')),r=o.records[0].get("u").properties,e.next=15,n.run("MATCH (visitor:User {name: $visitorName})-[r:CONNECTED_TO]->(holder:User)\n                 RETURN holder.name as holderName",{visitorName:b});case 15:if(i=e.sent,!(c=null===(a=i.records[0])||void 0===a?void 0:a.get("holderName"))){e.next=32;break}return at({source:t,target:c}),e.next=21,n.run("MATCH (existing:User {name: $existingName})-[r:CONNECTED_TO]->(holder:User {name: $holderName})\n                   RETURN r",{existingName:t,holderName:c});case 21:if(0!==e.sent.records.length){e.next=28;break}return e.next=25,n.run("MATCH (existing:User {name: $existingName}), (holder:User {name: $holderName})\n                     CREATE (existing)-[r:CONNECTED_TO]->(holder)\n                     SET r.createdAt = $timestamp",{existingName:t,holderName:c,timestamp:Date.now()});case 25:console.log('Created new connection from "'.concat(t,'" to "').concat(c,'"')),e.next=29;break;case 28:console.log('Connection from "'.concat(t,'" to "').concat(c,'" already exists'));case 29:return e.next=31,n.run("MATCH (visitor:User {name: $visitorName})\n                   DETACH DELETE visitor",{visitorName:b});case 31:console.log('Merged visitor into existing node "'.concat(t,'"'));case 32:Ue(!1),Se(""),Re(""),z(r),we(""),et(!0),console.log('Merged visitor into existing node "'.concat(t,'", focusing on existing node')),e.next=48;break;case 41:console.log('Node "'.concat(t,"\" doesn't exist, showing profile completion popup")),Ue(!1),Se(""),Re(""),He(!0),z({name:t,role:Oe,location:"",website:""}),K({name:t,role:Oe,location:"",website:""});case 48:e.next=53;break;case 50:e.prev=50,e.t0=e.catch(6),console.error("Error checking for existing node:",e.t0);case 53:return e.prev=53,n.close(),e.finish(53);case 56:case"end":return e.stop()}}),e,null,[[6,50,53,56]])})));return function(){return e.apply(this,arguments)}}(),kt=function(){var e=Object(g.a)(p.a.mark((function e(){var t,n,o,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G&&Pe){e.next=2;break}return e.abrupt("return");case 2:return t=w.session(),e.prev=3,e.next=6,t.run("MATCH (visitor:User {name: $visitorName}) \n               SET visitor.name = $newName, visitor.role = $role, visitor.location = $location, visitor.website = $website",{visitorName:b,newName:G.name,role:G.role||"",location:G.location||"",website:G.website||""});case 6:return console.log("Updated visitor profile: ".concat(G.name," with role: ").concat(G.role,", location: ").concat(G.location,", website: ").concat(G.website)),He(!1),e.next=10,t.run("MATCH (visitor:User {name: $visitorName})-[r:CONNECTED_TO]->(holder:User)\n               RETURN holder.name as holderName",{visitorName:G.name});case 10:return o=e.sent,(a=null===(n=o.records[0])||void 0===n?void 0:n.get("holderName"))?(at({source:G.name,target:a}),z({name:a,role:"",location:"",website:""}),we(""),et(!0)):(z(null),K(null),$e(""),at(null)),e.next=15,E(G.name);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),console.error("Error saving new profile from NFC:",e.t0);case 20:return e.prev=20,t.close(),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[3,17,20,23]])})));return function(){return e.apply(this,arguments)}}(),Ot=function(e,t,n){var o=e.toLowerCase(),a=t.records;if(console.log("Analytical question:",e),console.log("Generated query:",n),console.log("Query result:",t),console.log("Records:",a),0===a.length)return"I couldn't find any data matching your question.";if(o.includes("how many")||o.includes("count")){var r=a[0].get(0);return console.log("Count query result:",r),console.log("Question was:",e),o.includes("artist")?"There are ".concat(r," artists."):o.includes("user")?"There are ".concat(r," users."):o.includes("connection")||o.includes("relationship")?"There are ".concat(r," connections."):o.includes("craftsman")?"There are ".concat(r," craftsmen."):o.includes("entrepreneur")?"There are ".concat(r," entrepreneurs."):o.includes("educational institution")||o.includes("institution")?"There are ".concat(r," educational institutions."):o.includes("holder")?"There are ".concat(r," holder."):o.includes("program")?"There are ".concat(r," program."):"The count is ".concat(r,".")}if(o.includes("where")||o.includes("location")){var i=[];i=a[0].keys&&a[0].keys.includes("location")?a.map((function(e){return e.get("location")})).filter(Boolean):a[0].keys&&a[0].keys.includes("Location")?a.map((function(e){return e.get("Location")})).filter(Boolean):a[0].keys&&a[0].keys.includes("u_location")?a.map((function(e){return e.get("u_location")})).filter(Boolean):a[0].keys&&a[0].keys.includes("u_Location")?a.map((function(e){return e.get("u_Location")})).filter(Boolean):a.map((function(e){return e.get(0)})).filter(Boolean);var c=Object(l.a)(new Set(i));return 1===c.length?"The location is ".concat(c[0],"."):"The locations found are: ".concat(c.join(", "),".")}if(o.includes("role")||o.includes("what do")){var s=[];s=a[0].keys&&a[0].keys.includes("role")?a.map((function(e){return e.get("role")})).filter(Boolean):a[0].keys&&a[0].keys.includes("Role")?a.map((function(e){return e.get("Role")})).filter(Boolean):a[0].keys&&a[0].keys.includes("u_role")?a.map((function(e){return e.get("u_role")})).filter(Boolean):a[0].keys&&a[0].keys.includes("u_Role")?a.map((function(e){return e.get("u_Role")})).filter(Boolean):a.map((function(e){return e.get(0)})).filter(Boolean);var u=Object(l.a)(new Set(s));return 1===u.length?"The role is ".concat(u[0],"."):"The roles found are: ".concat(u.join(", "),".")}if(o.includes("who")||o.includes("name")){var d=[];return 1===(d=a[0].keys&&a[0].keys.includes("name")?a.map((function(e){return e.get("name")})).filter(Boolean):a[0].keys&&a[0].keys.includes("Name")?a.map((function(e){return e.get("Name")})).filter(Boolean):a[0].keys&&a[0].keys.includes("u_name")?a.map((function(e){return e.get("u_name")})).filter(Boolean):a[0].keys&&a[0].keys.includes("u_Name")?a.map((function(e){return e.get("u_Name")})).filter(Boolean):a.map((function(e){return e.get(0)})).filter(Boolean)).length?"The person is ".concat(d[0],"."):d.length<=5?"The people are: ".concat(d.join(", "),"."):"Found ".concat(d.length," people: ").concat(d.slice(0,3).join(", ")," and ").concat(d.length-3," more.")}if(o.includes("what roles exist")||o.includes("what roles are there")){var m=[];m=a[0].keys&&a[0].keys.includes("role")?a.map((function(e){return e.get("role")})).filter(Boolean):a[0].keys&&a[0].keys.includes("Role")?a.map((function(e){return e.get("Role")})).filter(Boolean):a[0].keys&&a[0].keys.includes("u_role")?a.map((function(e){return e.get("u_role")})).filter(Boolean):a[0].keys&&a[0].keys.includes("u_Role")?a.map((function(e){return e.get("u_Role")})).filter(Boolean):a.map((function(e){return e.get(0)})).filter(Boolean);var p=Object(l.a)(new Set(m));return p.length>0?"The roles found in the network are: ".concat(p.join(", "),"."):"I couldn't find any role information in the network."}var g=a.length;return 1===g?"I found 1 result matching your question.":"I found ".concat(g," results matching your question.")},Rt=function(e,t){ge({answer:e,question:t}),ve(!0),setTimeout((function(){ve(!1),ge(null)}),8e3)},Dt=function(e,t){var n,o,a=e.records;if(0===a.length)return"No network data found to analyze.";var r=[],i=new Map,c=new Map;a.forEach((function(e){var t=e.get("sourceName"),n=e.get("sourceRole"),o=e.get("sourceLocation"),a=e.get("targetName"),s=e.get("targetRole"),l=e.get("targetLocation"),u=e.get("connectionNote"),d=e.get("connectionTime");t&&i.set(t,{name:t,role:n,location:o}),a&&i.set(a,{name:a,role:s,location:l}),t&&a&&(c.set(t,(c.get(t)||0)+1),c.set(a,(c.get(a)||0)+1),r.push({source:t,target:a,note:u,time:d}))}));var s=Array.from(c.entries()).sort((function(e,t){return t[1]-e[1]})).slice(0,10).map((function(e){var t=Object(u.a)(e,2);return{name:t[0],count:t[1]}})),d=Array.from(i.values()).map((function(e){return e.location})).filter(Boolean),m=Object(l.a)(new Set(d)),p=Array.from(i.values()).map((function(e){return e.role})).filter(Boolean),g=Object(l.a)(new Set(p));return"# \ud83d\udcca **Network Analysis Report**\n\n## **\ud83c\udfaf Executive Summary**\n- **Total Users**: ".concat(i.size,"\n- **Total Connections**: ").concat(r.length,"\n- **Top Connector**: ").concat((null===(n=s[0])||void 0===n?void 0:n.name)||"N/A"," (").concat((null===(o=s[0])||void 0===o?void 0:o.count)||0," connections)\n- **Network Health**: ").concat(r.length>2*i.size?"Excellent":r.length>i.size?"Good":"Needs Improvement","\n\n## **\ud83c\udfc6 Top Network Connectors**\n").concat(s.slice(0,5).map((function(e,t){return"".concat(t+1,". **").concat(e.name,"** - ").concat(e.count," connections")})).join("\n"),"\n\n## **\ud83c\udf0d Demographics & Participation**\n- **Geographic Diversity**: ").concat(m.length," unique locations\n- **Professional Diversity**: ").concat(g.length," unique roles\n- **Participation Rate**: ").concat(Math.round(r.length/(i.size*(i.size-1)/2)*100),"% of possible connections\n\n## **\ud83d\udcc8 Network Statistics**\n| Metric | Value |\n|--------|-------|\n| **Total Users** | ").concat(i.size," |\n| **Total Connections** | ").concat(r.length," |\n| **Average Connections per User** | ").concat(Math.round(r.length/i.size*2)," |\n| **Unique Locations** | ").concat(m.length," |\n| **Unique Roles** | ").concat(g.length," |\n\n## **\ud83d\udca1 Key Insights**\n- The network shows ").concat(r.length>2*i.size?"strong":r.length>i.size?"moderate":"limited"," connectivity\n- Top connectors demonstrate effective networking skills\n- Geographic and professional diversity enhance network value\n\n## **\ud83c\udfaf Recommendations**\n- Encourage more connections between different communities\n- Support bridge nodes to maintain network resilience\n- Foster cross-cultural and cross-professional connections")},Lt=function(e,t,n){var o=e.records;if(console.log("generateNodeReport called with:",{nodeName:t,recordCount:o.length}),0===o.length)return"No data found for ".concat(t,". Please check the name and try again.");var a=[],r={},i=new Map;o.forEach((function(e,n){var o=e.get("sourceName"),c=e.get("sourceRole"),s=e.get("sourceLocation"),l=e.get("sourceWebsite"),u=e.get("targetName"),d=e.get("targetRole"),m=e.get("targetLocation"),p=e.get("targetWebsite"),g=e.get("connectionNote"),f=e.get("connectionTime");if(console.log("Record ".concat(n,":"),{sourceName:o,targetName:u,nodeName:t}),o&&o.toLowerCase()===t.toLowerCase()?(r.name=o,r.role=c,r.location=s,r.website=l,console.log("Found node info from source:",{name:o,role:c,location:s})):u&&u.toLowerCase()===t.toLowerCase()&&(r.name=u,r.role=d,r.location=m,r.website=p,console.log("Found node info from target:",{name:u,role:d,location:m})),o&&u&&o!==u){var h=o===t?u:o,E=o===t?d:c,v=o===t?m:s;i.set(h,{name:h,role:E,location:v,note:g,time:f}),a.push({source:o,target:u,note:g,time:f})}}));var c=i.size,s=Array.from(i.values()).map((function(e){return e.role})).filter(Boolean),d=Object(l.a)(new Set(s)),m=Array.from(i.values()).map((function(e){return e.location})).filter(Boolean),p=Object(l.a)(new Set(m)),g={};s.forEach((function(e){g[e]=(g[e]||0)+1}));var f=Object.entries(g).sort((function(e,t){return t[1]-e[1]})).slice(0,3),h={};m.forEach((function(e){h[e]=(h[e]||0)+1}));var E=Object.entries(h).sort((function(e,t){return t[1]-e[1]})).slice(0,3);return console.log("Final nodeInfo:",r),"# \ud83d\udc64 **Individual Network Analysis: ".concat(t,"**\n\n## **\ud83c\udfaf Profile Summary**\n- **Name**: ").concat(r.name||"N/A","\n- **Role**: ").concat(r.role||"N/A","\n- **Location**: ").concat(r.location||"N/A","\n- **Website**: ").concat(r.website||"N/A","\n- **Total Connections**: ").concat(c,"\n\n## **\ud83d\udd17 Connection Analysis**\n- **Network Reach**: ").concat(c," direct connections\n- **Role Diversity**: ").concat(d.length," different professional roles\n- **Geographic Reach**: ").concat(p.length," different locations\n\n## **\ud83d\udcca Top Connection Categories**\n\n### **Most Connected Roles**\n").concat(f.map((function(e){var t=Object(u.a)(e,2),n=t[0],o=t[1];return"- **".concat(n,"**: ").concat(o," connections")})).join("\n"),"\n\n### **Most Connected Locations**\n").concat(E.map((function(e){var t=Object(u.a)(e,2),n=t[0],o=t[1];return"- **".concat(n,"**: ").concat(o," connections")})).join("\n"),"\n\n## **\ud83c\udf0d Network Diversity**\n- **Professional Diversity**: ").concat(d.length," unique roles\n- **Geographic Diversity**: ").concat(p.length," unique locations\n- **Connection Quality**: ").concat(a.filter((function(e){return e.note})).length," connections with notes\n\n## **\ud83d\udca1 Key Insights**\n- ").concat(t," is a ").concat(c>20?"super connector":c>10?"active networker":"moderate connector","\n- ").concat(d.length>3?"High professional diversity":"Moderate professional diversity"," in connections\n- ").concat(p.length>5?"Strong geographic reach":"Local to regional focus"," in networking\n\n## **\ud83c\udfaf Network Impact**\n- **Bridge Potential**: ").concat(d.length>2&&p.length>3?"High - connects diverse communities":"Moderate - focused connections","\n- **Information Flow**: ").concat(c>15?"Excellent - high connectivity":c>8?"Good - moderate connectivity":"Limited - few connections","\n- **Resource Sharing**: ").concat(d.length>2?"Strong - diverse professional network":"Focused - similar professional backgrounds")},Mt=function(e,t){var n=e.replace(/# \ud83d\udcca \*\*Network Analysis Report\*\*/g,'<h1 style="color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; margin-bottom: 20px;">\ud83d\udcca Network Analysis Report</h1>').replace(/## \*\*\ud83c\udfaf Executive Summary\*\*/g,'<h2 style="color: #34495e; background: #ecf0f1; padding: 10px; border-radius: 5px; margin: 20px 0 15px 0;">\ud83c\udfaf Executive Summary</h2>').replace(/## \*\*\ud83c\udfc6 Top Network Connectors\*\*/g,'<h2 style="color: #34495e; background: #ecf0f1; padding: 10px; border-radius: 5px; margin: 20px 0 15px 0;">\ud83c\udfc6 Top Network Connectors</h2>').replace(/## \*\*\ud83c\udf0d Demographics & Participation\*\*/g,'<h2 style="color: #34495e; background: #ecf0f1; padding: 10px; border-radius: 5px; margin: 20px 0 15px 0;">\ud83c\udf0d Demographics & Participation</h2>').replace(/## \*\*\ud83d\udcc8 Network Statistics\*\*/g,'<h2 style="color: #34495e; background: #ecf0f1; padding: 10px; border-radius: 5px; margin: 20px 0 15px 0;">\ud83d\udcc8 Network Statistics</h2>').replace(/## \*\*\ud83d\udca1 Key Insights\*\*/g,'<h2 style="color: #34495e; background: #ecf0f1; padding: 10px; border-radius: 5px; margin: 20px 0 15px 0;">\ud83d\udca1 Key Insights</h2>').replace(/## \*\*\ud83c\udfaf Recommendations\*\*/g,'<h2 style="color: #34495e; background: #ecf0f1; padding: 10px; border-radius: 5px; margin: 20px 0 15px 0;">\ud83c\udfaf Recommendations</h2>').replace(/\*\*(.*?)\*\*/g,'<strong style="color: #e74c3c;">$1</strong>').replace(/- \*\*(.*?)\*\*: (.*?)$/gm,'<li style="margin: 8px 0; padding: 5px 0; border-left: 3px solid #3498db; padding-left: 15px;"><strong style="color: #e74c3c;">$1</strong>: $2</li>').replace(/(\d+)\. \*\*(.*?)\*\* - (\d+) connections/g,'<li style="margin: 8px 0; padding: 8px; background: #f8f9fa; border-radius: 4px; border-left: 4px solid #27ae60;"><strong style="color: #e74c3c;">$2</strong> - <span style="color: #27ae60; font-weight: bold;">$3 connections</span></li>').replace(/\| (.*?) \| (.*?) \|/g,'<tr><td style="padding: 8px; border: 1px solid #ddd; background: #f8f9fa; font-weight: bold;">$1</td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">$2</td></tr>').replace(/\|--------\|-------\|/g,"").replace(/- (.*?)$/gm,'<li style="margin: 5px 0; padding: 3px 0;">$1</li>'),o='\n            <div style="\n              max-height: 70vh; \n              overflow-y: auto; \n              padding: 20px; \n              background: white; \n              border-radius: 8px; \n              box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n              font-family: \'Segoe UI\', Tahoma, Geneva, Verdana, sans-serif;\n              line-height: 1.6;\n              color: #2c3e50;\n            ">\n              <div style="margin-bottom: 20px;">\n                '.concat(n,"\n              </div>\n            </div>\n          ");ge({answer:o,question:"Network Analysis Report",isHtml:!0}),ve(!0),setTimeout((function(){ve(!1),ge(null)}),3e4)};return a.a.createElement("div",{width:"95%"},a.a.createElement("input",{type:"text",placeholder:"Show me all the MSEI students from CA",style:{display:"block",width:"95%",height:"40px",margin:"0 auto",textAlign:"center",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"},value:_,onChange:function(e){var t=e.target.value;F(t),h(e),C(),t.trim()&&(ne(null),ie("search"),dt&&(clearTimeout(dt),mt(null)),ht(!1))},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),wt(e))}}),a.a.createElement("button",{id:"visualize",onClick:function(){return window.open("https://awuchen.github.io/greif-network-3d/","_blank")}},"Visualize3D"),a.a.createElement("button",{id:"info",onClick:function(){return window.open("https://www.hako.soooul.xyz/drafts/washi","_blank")}},"Info"),a.a.createElement("button",{id:"timeline",onClick:U},R?"Exit Timeline":"Timeline"),R&&a.a.createElement("div",{style:{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:"white",padding:"15px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"400px",textAlign:"center"}},a.a.createElement("h4",{style:{margin:"0 0 10px 0",color:"#333"}},"Network Timeline"),a.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"}},a.a.createElement("button",{onClick:function(){if(D){var e=new Date(D.getTime()-6e4);I(e)}},style:{backgroundColor:"#2196F3",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px"}},"-1m"),a.a.createElement("input",{type:"range",min:(null===M||void 0===M||null===(t=M.earliest)||void 0===t?void 0:t.getTime())||Date.now()-864e5,max:(null===M||void 0===M||null===(n=M.latest)||void 0===n?void 0:n.getTime())||Date.now(),value:(null===D||void 0===D?void 0:D.getTime())||Date.now(),step:6e4,onChange:function(e){var t=parseInt(e.target.value),n=new Date(t);I(n)},style:{flex:1}}),a.a.createElement("button",{onClick:function(){if(D){var e=new Date(D.getTime()+6e4);I(e)}},style:{backgroundColor:"#2196F3",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px"}},"+1m"),a.a.createElement("span",{style:{fontSize:"12px",color:"#666",minWidth:"120px"}},D?"".concat(D.toLocaleDateString()," ").concat(D.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})):"Current Time")),a.a.createElement("div",{style:{display:"flex",gap:"10px",justifyContent:"center",marginBottom:"10px"}},a.a.createElement("button",{onClick:function(){if(D){var e=new Date(D.getTime()-3e5);I(e)}},style:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px"}},"-5m"),a.a.createElement("button",{onClick:function(){return j(new Date)},style:{backgroundColor:"#9C27B0",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"}},"Load Current"),a.a.createElement("button",{onClick:function(){if(D){var e=new Date(D.getTime()+3e5);I(e)}},style:{backgroundColor:"#4CAF50",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"10px"}},"+5m")),L&&a.a.createElement("div",{style:{fontSize:"11px",color:"#666",display:"flex",justifyContent:"space-between"}},a.a.createElement("span",null,"Nodes: ",L.nodes.length),a.a.createElement("span",null,"Connections: ",L.links.length),a.a.createElement("span",null,"Time: ",null===D||void 0===D?void 0:D.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}))),M&&a.a.createElement("div",{style:{fontSize:"10px",color:"#999",marginTop:"8px",textAlign:"center"}},"Timeline: ",null===(r=M.earliest)||void 0===r?void 0:r.toLocaleDateString()," ",null===(i=M.earliest)||void 0===i?void 0:i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),"to ",null===(d=M.latest)||void 0===d?void 0:d.toLocaleDateString()," ",null===(m=M.latest)||void 0===m?void 0:m.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))),x&&a.a.createElement("div",{style:{position:"fixed",top:"60px",right:"10px",padding:"8px 12px",backgroundColor:"#9C27B0",color:"white",borderRadius:"4px",fontSize:"12px",zIndex:1e3,display:"flex",alignItems:"center",gap:"8px"}},a.a.createElement("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"#fff",animation:"pulse 0.5s infinite"}}),"Processing Mutation..."),Ee&&pe&&a.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",maxWidth:"800px",maxHeight:"80vh",backgroundColor:"white",border:"2px solid #3498db",borderRadius:"10px",boxShadow:"0px 0px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},onClick:function(e){return e.stopPropagation()}},a.a.createElement("div",{style:{padding:"15px 20px",backgroundColor:"#3498db",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"}},a.a.createElement("h3",{style:{margin:0,fontSize:"18px"}},pe.question),a.a.createElement("button",{onClick:function(){ve(!1),ge(null)},style:{background:"none",border:"none",color:"white",fontSize:"20px",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"}},"\xd7")),a.a.createElement("div",{style:{padding:"0",maxHeight:"calc(80vh - 60px)",overflow:"hidden"}},pe.isHtml?a.a.createElement("div",{dangerouslySetInnerHTML:{__html:pe.answer}}):a.a.createElement("div",{style:{padding:"20px",maxHeight:"calc(80vh - 60px)",overflowY:"auto"}},a.a.createElement("p",null,a.a.createElement("strong",null,"Answer:")," ",pe.answer)))),a.a.createElement("style",null,"\n        @keyframes pulse {\n          0% { opacity: 1; }\n          50% { opacity: 0.5; }\n          100% { opacity: 1; }\n        }\n        \n        @keyframes breathe {\n          0%, 100% { \n            transform: scale(1);\n            opacity: 1;\n          }\n          50% { \n            transform: scale(1.5);\n            opacity: 0.7;\n          }\n        }\n      "),a.a.createElement(N.a,{ref:v,graphData:R&&L?L:f,nodeId:"name",nodeLabel:function(e){return e.role||"No Program Specified"},linkLabel:function(e){return ct&&ct.link===e?ct.note||"No note added":null},onNodeClick:function(e){e&&(z(e),K(Object(s.a)({},e)),X(e.name),ne(e.name),ie("click"),we(""),C(),F(""),dt&&(clearTimeout(dt),mt(null)),ht(!1))},onNodeHover:function(e){X(e?e.name:null)},onLinkClick:xt,onLinkHover:Ct,onBackgroundClick:function(){X(null),ne(null),ie(null),ue([]),z(null),ve(!1),ge(null),qe(null),Je({})},nodeCanvasObject:function(e,t){var n=_&&(e.name.toLowerCase().includes(_.toLowerCase())||e.location&&e.location.toLowerCase().includes(_.toLowerCase())||e.role&&e.role.toLowerCase().includes(_.toLowerCase())||e.website&&e.website.toLowerCase().includes(_.toLowerCase())),o=Tt.has(e.name);t.globalAlpha=o?1:.2;var a=6,r=Date.now(),i=60*Math.floor(r/60)*.001;if(y){if(S&&r-S<A){var c=Math.min((r-S)/A,1),s=1+.1*Math.sin(.001*S*.8);a=6*(s+(1-s)*c)}}else a=6*(1+.1*Math.sin(.8*i));var l="white";if(e.name===b?l="black":e.name===T?l="green":e.name===te&&(l="gray"),y||"white"!==l){if(S&&r-S<A&&"white"===l){var u=(r-S)/A,d=.1*Math.sin(.001*S*.8)*(1-u);l="rgb(".concat(255+50*d,", ").concat(255+30*d,", ").concat(255+100*d,")")}}else{var m=.1*Math.sin(.8*i);l="rgb(".concat(255+50*m,", ").concat(255+30*m,", ").concat(255+100*m,")")}t.fillStyle=l,t.strokeStyle=n?"red":"black",t.lineWidth=n?3:2,t.beginPath(),t.arc(e.x||500*Math.random(),e.y||500*Math.random(),a,0,2*Math.PI),t.fill(),t.stroke(),t.shadowBlur=0,t.fillStyle="gray";var p=e.name.split(" ")[0];t.fillText(p,e.x+10,e.y),t.globalAlpha=1},linkColor:function(e){var t="object"===typeof e.source?e.source.name:e.source,n="object"===typeof e.target?e.target.name:e.target,o=Tt.has(t)&&Tt.has(n);return ct&&ct.link===e?"#000":o?"#999":"#ccc"},linkOpacity:function(e){var t="object"===typeof e.source?e.source.name:e.source,n="object"===typeof e.target?e.target.name:e.target;return Tt.has(t)&&Tt.has(n)?1:.15},linkCurvature:.2,linkDirectionalArrowRelPos:1,linkDirectionalArrowLength:5}),Me&&a.a.createElement("div",{style:{position:"absolute",top:"20%",left:"50%",transform:"translate(-50%, -50%)",padding:"20px",backgroundColor:"white",border:"1px solid black",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.3)",zIndex:1e3,minWidth:"300px"},onClick:function(e){return e.stopPropagation()}},a.a.createElement("h3",null,"Enter Info"),a.a.createElement("p",null,a.a.createElement("strong",null,"Name:"),a.a.createElement("input",{value:ye,onChange:function(e){return Se(e.target.value)},placeholder:"Enter your name",style:{width:"100%",marginTop:"5px",padding:"5px"},onKeyPress:function(e){"Enter"===e.key&&At()}})),a.a.createElement("p",null,a.a.createElement("strong",null,"Program:"),a.a.createElement("input",{value:Oe,onChange:function(e){return Re(e.target.value)},placeholder:"e.g., MSEI, MSSE, MSBA, MBA, etc.",style:{width:"100%",marginTop:"5px",padding:"5px"},onKeyPress:function(e){"Enter"===e.key&&At()}})),a.a.createElement("p",null,a.a.createElement("button",{onClick:At,style:{marginRight:"10px",padding:"8px 16px"}},"Continue"),a.a.createElement("button",{onClick:function(){Ue(!1),Se(""),Re("")},style:{padding:"8px 16px"}},"Cancel"))),We&&B&&G&&a.a.createElement("div",{style:{position:"absolute",top:"20%",left:"50%",transform:"translate(-50%, -50%)",padding:"20px",backgroundColor:"white",border:"1px solid black",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.3)",zIndex:1e3,minWidth:"300px"},onClick:function(e){return e.stopPropagation()}},a.a.createElement("h3",null,"Complete Your Profile"),a.a.createElement("p",null,a.a.createElement("strong",null,"Name:"),a.a.createElement("input",{name:"name",value:G.name,placeholder:"Enter your name",onChange:yt,style:{width:"100%",marginTop:"5px",padding:"5px"}})),a.a.createElement("p",null,a.a.createElement("strong",null,"Program:"),a.a.createElement("input",{name:"role",value:G.role||"",placeholder:"e.g., MSEI, MBA, BS, MS, PhD",onChange:yt,style:{width:"100%",marginTop:"5px",padding:"5px"}})),a.a.createElement("p",null,a.a.createElement("strong",null,"Location:"),a.a.createElement("input",{name:"location",value:G.location||"",placeholder:"e.g., Los Angeles, CA",onChange:yt,style:{width:"100%",marginTop:"5px",padding:"5px"}})),a.a.createElement("p",null,a.a.createElement("strong",null,"Email/Website:"),a.a.createElement("input",{name:"website",value:G.website||"",placeholder:"your.email@example.com",onChange:yt,style:{width:"100%",marginTop:"5px",padding:"5px"}})),a.a.createElement("p",null,a.a.createElement("button",{onClick:kt,style:{marginRight:"10px",padding:"8px 16px"}},"Save Profile"),a.a.createElement("button",{onClick:function(){return He(!1)},style:{padding:"8px 16px"}},"Cancel"))),B&&!We&&!Me&&!Ye&&a.a.createElement("div",{style:{position:"absolute",top:"20%",left:"50%",transform:"translate(-50%, -50%)",padding:"20px",backgroundColor:"white",border:"1px solid black",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.3)",zIndex:1e3,minWidth:"300px"},onClick:function(e){return e.stopPropagation()}},a.a.createElement("h3",null,"Network Info"),a.a.createElement("p",null,a.a.createElement("strong",null,"Name:")," ",null===B||void 0===B?void 0:B.name),(null===B||void 0===B?void 0:B.role)&&a.a.createElement("p",null,a.a.createElement("strong",null,"Program:")," ",B.role),(null===B||void 0===B?void 0:B.location)&&a.a.createElement("p",null,a.a.createElement("strong",null,"Location:")," ",B.location),(null===B||void 0===B?void 0:B.website)&&a.a.createElement("p",null,a.a.createElement("strong",null,"Email:")," ",a.a.createElement("a",{href:"mailto:".concat(B.website)},B.website.length>30?"".concat(B.website.substring(0,30),"..."):B.website))),Ye&&B&&a.a.createElement("div",{style:{position:"absolute",top:"20%",left:"50%",transform:"translate(-50%, -50%)",padding:"20px",backgroundColor:"white",border:"1px solid black",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.3)",zIndex:1e3,minWidth:"300px"},onClick:function(e){return e.stopPropagation()}},a.a.createElement("h3",null,"Add Connection Note"),a.a.createElement("p",null,a.a.createElement("strong",null,"Connected to:")," ",null===B||void 0===B?void 0:B.name),(null===B||void 0===B?void 0:B.role)&&a.a.createElement("p",null,a.a.createElement("strong",null,"Program:")," ",B.role),(null===B||void 0===B?void 0:B.location)&&a.a.createElement("p",null,a.a.createElement("strong",null,"Location:")," ",B.location),(null===B||void 0===B?void 0:B.website)&&a.a.createElement("p",null,a.a.createElement("strong",null,"Email:")," ",a.a.createElement("a",{href:"mailto:".concat(B.website)},B.website.length>30?"".concat(B.website.substring(0,30),"..."):B.website)),a.a.createElement("p",null,a.a.createElement("strong",null,"Note:"),a.a.createElement("textarea",{value:Ne,onChange:function(e){return we(e.target.value)},placeholder:"e.g., Met at USC networking event, Introduced by mutual friend, Worked together on project...",style:{width:"100%",marginTop:"5px",padding:"5px",minHeight:"80px",resize:"vertical"}})),a.a.createElement("p",null,a.a.createElement("button",{onClick:St,style:{padding:"8px 16px"}},"Save"))),Qe&&Ve&&a.a.createElement("div",{style:{position:"absolute",top:"30%",left:"50%",transform:"translate(-50%, -50%)",padding:"20px",backgroundColor:"white",border:"1px solid black",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.3)",zIndex:1e3,minWidth:"300px"},onClick:function(e){return e.stopPropagation()}},a.a.createElement("h3",null,"Connection Details"),a.a.createElement("p",null,a.a.createElement("strong",null,"From:")," ",Ve.sourceName),a.a.createElement("p",null,a.a.createElement("strong",null,"To:")," ",Ve.targetName),Ve.note?a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null,a.a.createElement("strong",null,"Note:")),a.a.createElement("div",{style:{backgroundColor:"#f5f5f5",padding:"10px",borderRadius:"4px",marginTop:"5px",fontStyle:"italic"}},'"',Ve.note,'"')):a.a.createElement("p",{style:{color:"#666",fontStyle:"italic"}},"No note added yet.")))},A=C;var k=function(e){var t=e.driver;return a.a.createElement("div",{className:"App"},a.a.createElement(A,{driver:t}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var O=n(143),R=O.driver(Object({NODE_ENV:"production",PUBLIC_URL:"/MITNet",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).NEO4J_URI||"neo4j+s://23f1f8d0.databases.neo4j.io",O.auth.basic(Object({NODE_ENV:"production",PUBLIC_URL:"/MITNet",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).NEO4J_USER||"neo4j",Object({NODE_ENV:"production",PUBLIC_URL:"/MITNet",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).NEO4J_PASSWORD||"xQ3FQK4HZq5o-lbJJD5yHrTSdJQiejLW3iiejdoGs_E"),{});i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(k,{driver:R})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[218,1,2]]]);
//# sourceMappingURL=main.aa7dac6b.chunk.js.map